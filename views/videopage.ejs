 <nav class="nav-inline position-right box-shadow-l">
  <ul>
    <li>
      <a href="index" class="button button-s nav-button box-shadow-l">Home</a>
    </li>
    <li class="float-right">
      <a href="login.html" class="button button-s nav-button box-shadow-l">Login</a>
    </li>
    <li class="float-right">
      <a href="..." class="button button-s nav-button box-shadow-l">Tutorials</a>
    </li>
    <li class="float-right">
      <a href="..." class="button button-s nav-button box-shadow-l">Register</a>
    </li>
  </ul>
</nav>

  <main >

  	<section>
      <div class="container margin-bottom-xl margin-top-xl margin-left-l">
        <h1 class="video-heading" id="title"><%= heading %></h1>
     </div> 
    </section>

    <section>
      <div class="flex-center margin-bottom-xl">

        <div id="yplayer">
<iframe id="video" width="853" height="480" src="<%= videolink %>" frameborder="0" allow="accelerometer; autoplay; clipboard-write; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>

      </div>

      <div class="flex-center margin-bottom-xl padding-top-s padding-bottom-s background-light-900 border-radius" style="margin-right: 450px; margin-left: 450px">
        <button class="margin-right-m" type="submit" id="test"> Save Video </button>
        <button class="margin-right-m" type="submit" id="resume"> Resume </button>

        <button  type="submit" id="check"> CheckPoint </button>
      </div>
    </section>

  </main>

  <footer class="footer padding-vertical-xl border-top border-color-primary-600 segmentcolor">
  <div class="container">

    <div class="text-align-center">
    <h2 class="display-title display-title-l margin-bottom-m">Digital Story Telling</h2>
    <nav class="nav-inline">
      <li>
        <a href="">Contact</a>
      </li>
      <li>
        | 
      </li>
      <li>
        <a href="">Mission</a>
      </li>
      <li>
        | 
      </li>
      <li>
        <a href="">Contribute</a>
      </li>
    </nav>
  </div>

  </div>
</footer>

<script>
let vidname = document.querySelector("#title").textContent


let vid = document.querySelector("#video")
let id = vid.src.split("embed/")[1]
// Get the Video ID
console.log(id)

let check = document.querySelector("#check")


let x = document.querySelector('#resume')
var tag = document.createElement('script');

      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      // 3. This function creates an <iframe> (and YouTube player)
      //    after the API code downloads.
      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('yplayer', {
          videoId: id,
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
      }

function onPlayerReady(event) {
        event.target.playVideo();
      }

      // 5. The API calls this function when the player's state changes.
      //    The function indicates that when playing a video (state=1),
      //    the player should play for six seconds and then stop.
      var done = false;
      function onPlayerStateChange(event) {
        if (event.data == YT.PlayerState.PLAYING && !done) {
          player.seekTo( <%= time %>)
          // setTimeout(stopVideo, 5000);

          done = true;
        }
      }
      function stopVideo() {
        console.log("pause video here")
        player.pauseVideo();
      }

check.addEventListener('click', (e) => {
  player.seekTo(10)
  player.pauseVideo()
})



let vidtime = [];
// x.addEventListener('click', (e) => {
//   // console.log("test")
//   console.log(player.playerInfo.currentTime)
//   vidtime.push(player.playerInfo.currentTime)
// })


// Player will click save button. POST request to save, video timestamp saved. When the video starts
// it should go to the saved position



let n = document.querySelector("#test")
// n.addEventListener('click', (e) => {
//   console.log("test")
// })

n.addEventListener('click', (e) => {

console.log(player.playerInfo.currentTime)
vidtime.push(player.playerInfo.currentTime)
let data = {content: vidtime, name: vidname}

  fetch("/save", {
  method: "POST",
  body: JSON.stringify(data),
  headers: {
    "Content-Type": "application/json"
  },
  credentials: "same-origin"
}).then(function(response) {
  response.status     //=> number 100â€“599
  response.statusText //=> String
  response.headers    //=> Headers
  response.url        //=> String

  return response.text()
}, function(error) {
  error.message //=> String
})
})


</script>